<!DOCTYPE html>
<html>
    <head>
        <link rel= "stylesheet" type= "text/css" href= "../static/styles/style.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js" integrity="sha512-q/dWJ3kcmjBLU4Qc47E4A9kTB4m3wuTY7vkFJDTZKjTs8jhyGQnaUrxa0Ytd0ssMZhbNua9hE+E7Qv1j+DyZwA==" crossorigin="anonymous"></script>
    </head>
    <body>
        <h1>SuperCringe Admin panel</h1>

        <div id="MainPanel">
            <p id="Count">Počet uživatelů: </p>
            <p id="Mean">Průměrná doba čekání: </p>

            <div id="Users" style="width: 100%; height:100%;">
                <div style="background-color: rgb(151, 141, 141); width: 100%; height: 75px; border-radius: 10px;">
                    <div class="LeftAlign" style="padding-top: 10px; padding-left: 10px; float: left;">
                        <p style="margin: 0; ">JMÉNO: </p>
                        <p style="margin: 0;">ID: </p>
                    </div>
                    <div class="RighAlign" style="float:right; text-align: center;">
                        <i class="fa fa-trash" aria-hidden="true" style="font-size: 36px; padding-top:16px; padding-right: 10px;" onclick="Delete()"></i>
                    </div>
                </div>
            </div>
        </div>
        <script type="text/javascript" charset="utf-8">
            var socket = io("127.0.0.1:5000");
            function UpdateValues(data_json){

                var Count = document.getElementById("Count")
                var Mean = document.getElementById("Mean")
                var UserField = document.getElementById("Users")

                data = JSON.parse(data_json)
                console.log(data)

                //modify user count
                Count.innerHTML = "Počet uživatelů: " + data["user_len"]
                
                //modify whole user field

                //delete all children
                UserField.textContent = "";
                //load new children
                for(i = 0; i < data["user_len"]; i++){
                    var User = document.createElement("div");
                    var LeftAlign = document.createElement("div")
                    var RightAlign = document.createElement("div")

                    var Name = document.createElement("p")
                    var ID = document.createElement("p")
                    var DelIcon = document.createElement("i")
                    
                    

                    if(data["user_data"].length == 0){
                        console.log("Žádné data")
                    }
                    else{
                        console.log("nějaké data")
                    }
                }
            }
            
            socket.on('connect', function() {
                while(True){
                    socket.emit("message", {data: "request-data"});
                    socket.on("update", (data) => {
                        console.log("Update")
                        console.log(data)
                        setTimeout(1000, UpdateValues(data));  
                    })
                }
                
            });
        </script>
    </body>
</html>